# API de Consulta de Cr√©ditos/ NFSe

![Java Badge](https://camo.githubusercontent.com/bea90da226e09b503e6c8fde824f4816b98dcf30cd31e803006bf6335af06890/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6a6176612d2532334544384230302e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d6f70656e6a646b266c6f676f436f6c6f723d7768697465) <!-- Badge do Java -->
![Spring Badge](https://camo.githubusercontent.com/9ee242f2c2b1eb587f7e42704b3a0629082aac88f66fff96d34723f777b07775/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f737072696e672d2532333644423333462e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d737072696e67266c6f676f436f6c6f723d7768697465) <!-- Badge do Spring -->
![Postgres Badge](https://camo.githubusercontent.com/544022edf8369d944e68802fc043b0268484709e334d23db2882590aeae296cb/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f706f7374677265732d2532333331363139322e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d706f737467726573716c266c6f676f436f6c6f723d7768697465) <!-- Badge do PostgreSQL -->

## Vis√£o Geral

A API de Consulta de Cr√©ditos NFSe √© uma solu√ß√£o robusta desenvolvida em Spring Boot para gerenciamento e consulta de cr√©ditos fiscais. O sistema oferece endpoints RESTful para acesso seguro e eficiente aos dados de cr√©ditos NFSe, com foco em performance e facilidade de integra√ß√£o.

## ‚ú® Principais Funcionalidades

- **Consultas Avan√ßadas**
  - Busca de cr√©ditos por n√∫mero da NFSe
  - Pesquisa por n√∫mero do cr√©dito
  - Filtros combinados para consultas complexas

- **Arquitetura Moderna**
  - Padr√£o DTO para transfer√™ncia otimizada de dados
  - Mapeamento inteligente com ModelMapper
  - Separa√ß√£o clara de responsabilidades (Controller-Service-Repository)

- **Persist√™ncia de Dados**
  - Integra√ß√£o com PostgreSQL
  - Utiliza√ß√£o do Spring Data JPA
  - Consultas otimizadas com JPA Query Methods

- **Pronto para Produ√ß√£o**
  - Documenta√ß√£o Swagger/OpenAPI integrada
  - Tratamento de erros personalizado
  - Configura√ß√µes de seguran√ßa b√°sica

## üöÄ Como Utilizar

### Pr√©-requisitos
- Java 17+
- PostgreSQL 14+
- Maven 3.6+

### Instala√ß√£o
```bash
git clone https://github.com/seu-usuario/api-credito-nfse.git
cd api-credito-nfse
mvn install
```

### Configura√ß√£o
Edite o arquivo `application.properties` com suas credenciais:
```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/nfse_db
spring.datasource.username=seu_usuario
spring.datasource.password=sua_senha
```

### Execu√ß√£o
```bash
mvn spring-boot:run
```

## Cria√ß√£o e Popula√ß√£o da Tabela `credito`

### Script de Cria√ß√£o da Tabela

Para criar a tabela `credito` no seu banco de dados, utilize o seguinte script SQL:

```sql
CREATE TABLE credito
(
    id             BIGINT GENERATED BY DEFAULT AS IDENTITY,
    numero_credito VARCHAR(50) NOT NULL,
    numero_nfse    VARCHAR(50) NOT NULL,
    data_constituicao DATE NOT NULL,
    valor_issqn    DECIMAL(15, 2) NOT NULL,
    tipo_credito   VARCHAR(50) NOT NULL,
    simples_nacional BOOLEAN NOT NULL,
    aliquota       DECIMAL(5, 2) NOT NULL,
    valor_faturado DECIMAL(15, 2) NOT NULL,
    valor_deducao  DECIMAL(15, 2) NOT NULL,
    base_calculo   DECIMAL(15, 2) NOT NULL
);

INSERT INTO credito (numero_credito, numero_nfse, data_constituicao, valor_issqn, tipo_credito, simples_nacional, aliquota, valor_faturado, valor_deducao, base_calculo)
VALUES
('123456', '7891011', '2024-02-25', 1500.75, 'ISSQN', true, 5.0, 30000.00, 5000.00, 25000.00),
('789012', '7891011', '2024-02-26', 1200.50, 'ISSQN', false, 4.5, 25000.00, 4000.00, 21000.00),
('654321', '1122334', '2024-01-15', 800.50, 'Outros', true, 3.5, 20000.00, 3000.00, 17000.00);
```

## Cria√ß√£o e Popula√ß√£o da Tabela `credito`

### ESTRUTURA DA API
``` 
GET /api/creditos/{numeroNfse}
Descri√ß√£o: Retorna uma lista de cr√©ditos constitu√≠dos com base no n√∫mero da NFS-e.
Par√¢metro:
¬∑   	numeroNfse (String) - N√∫mero identificador da NFS-e
Resposta esperada:
[
  {
	"numeroCredito": "123456",
	"numeroNfse": "7891011",
	"dataConstituicao": "2024-02-25",
	"valorIssqn": 1500.75,
	"tipoCredito": "ISSQN",
	"simplesNacional": "Sim",
	"aliquota": 5.0,
	"valorFaturado": 30000.00,
	"valorDeducao": 5000.00,
	"baseCalculo": 25000.00
  }
]

GET /api/creditos/credito/{numeroCredito}
Descri√ß√£o: Retorna os detalhes de um cr√©dito constitu√≠do espec√≠fico com base no n√∫mero do cr√©dito constitu√≠do.
Par√¢metro:
numeroCredito (String) - N√∫mero identificador do cr√©dito constitu√≠do
Resposta esperada:
{
  "numeroCredito": "123456",
  "numeroNfse": "7891011",
  "dataConstituicao": "2024-02-25",
  "valorIssqn": 1500.75,
  "tipoCredito": "ISSQN",
  "simplesNacional": "Sim",
  "aliquota": 5.0,
  "valorFaturado": 30000.00,
  "valorDeducao": 5000.00,
  "baseCalculo": 25000.00
}

```
## üìö Instala√ß√£o do Kafka

Para utilizar a funcionalidade de mensageria da API, √© necess√°rio instalar o Apache Kafka. Siga os passos abaixo:

### 1. Baixe o Apache Kafka
- Acesse o site oficial: [https://kafka.apache.org/downloads](https://kafka.apache.org/downloads)
- Baixe a vers√£o mais recente (recomendado vers√£o bin√°ria)

### 2. Extraia o arquivo
```bash
tar -xzf kafka_2.13-3.6.1.tgz  # substitua pelo nome do arquivo baixado
cd kafka_2.13-3.6.1
```

## üèóÔ∏è Estrutura do Projeto

```plaintext
src/
‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îú‚îÄ‚îÄ java/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ com/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ venicios/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ api_credito_nfse/
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ core/              # Configura√ß√µes do sistema
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ controller/        # Endpoints da API
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ dto/               # Data Transfer Objects
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ exception/         # Tratamento de erros
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ model/             # Entidades JPA
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ repository/        # Camada de persist√™ncia
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ service/           # L√≥gica de neg√≥cios
‚îÇ   ‚îÇ              
‚îÇ   |   ‚îú‚îÄ‚îÄ application.properties         # Configura√ß√µes
‚îî‚îÄ‚îÄ test/                                  # Testes unit√°rios e integra√ß√£o
```

## ü§ù Contribui√ß√£o

Contribui√ß√µes s√£o bem-vindas! Siga estes passos:

1. Fa√ßa um fork do projeto
2. Crie uma branch (`git checkout -b feature/nova-funcionalidade`)
3. Commit suas mudan√ßas (`git commit -m 'Adiciona nova funcionalidade'`)
4. Push para a branch (`git push origin feature/nova-funcionalidade`)
5. Abra um Pull Request

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a licen√ßa MIT - veja o arquivo [LICENSE](LICENSE) para detalhes.

---

**Desenvolvido por** [Marcos Venicios Evangelista Chaves  
**Contato**: markusvynycyus@hotmail.com  
**Vers√£o**: 1.0.0
